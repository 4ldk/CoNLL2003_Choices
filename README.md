# CoNLL2003 choices data

The json data in this repositoty was generated by 500 inferences each sentences on CoNLL2003 train, validation, test data, CoNLL++ (2023) and CoNLL++ (CrossWeigh), using subword regularization(BPE-Dropout).
- For the training data, data was generated by five rounds of inference for 20% of the train data by the model trained on the remaining 80%. (train_cross_var.py)
- For the other data, data was generated by inference by all train data. (train_all_train_data.py)

All datasets can be found at `choice_data/`

We removed the original token and label data. Therefore, only the inference labels, the number of times they were inferenced in 500, and the f1 score with the golden labels are available in this repository. If you have original CoNLL2003 data, you can add original token and label data to our datasets.
- f1 score is calculated by [seqeval](https://github.com/chakki-works/seqeval), but there are only O labels in both of inferenced labels and golden labels, we set the score at 1.0.

## Setting
1. `git clone git@github.com:4ldk/CoNLL2003_Choices.git`
2. `cd CoNLL2003_Choices`
3. `mkdir row_data`
4. Copy each data to `row_data/`
    - Copy Original data (`eng.train`, `eng.testa`, `eng.tesb`) directly.
        - The following two repositories also have original data, but some data that are not suitable for training have been erased. The data and models published in this repository is based on data that has not been erased.
    - Copy `conllpp.txt` of [CoNLL++(2023)](https://github.com/ShuhengL/acl2023_conllpp) directly.
    - Copy `conllpp_test.txt` of [CoNLL++(CrossWeigh)](https://github.com/ZihanWangKi/CrossWeigh) as `conllcw.txt`
5. `pip install -r requirement.txt`

## Add Original label and token information to choice_data
1. `python3 ./src/add_row_data.py`

## Create choice data by using trained model
1. `mkdir model`
2. Download models from Google Drive and place them in `model/`. (comming soon)
3. Edit `config/config2003.yaml` to set the model to use, inference data, and iteration of inferences.
4. `python3 ./src/predictor.py`

## Train model and create train choice data
1. Edit `config/config2003.yaml`
2. If you want to change the number of divisions in the train data, Change line 12 of `make_cross_data.py` and lines 106 and 108 of `train_cross_var.py`.
3. `python3 ./src/make_cross_data.py`
4. `python3 ./src/train_cross_var.py`

## Train model by all train data and create choice data
1. Edit `config/config2003.yaml`
2. `python3 ./src/train_all_train_data.py`
3. `python3 ./src/predictor.py`

